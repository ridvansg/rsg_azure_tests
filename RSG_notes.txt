az group create -l eastus -n rgDataMigration

az deployment group create --resource-group rgDataMigration --template-uri https://raw.githubusercontent.com/ridvansg/rsg_azure_tests/main/event-grid-rsg/RsgEventHubsDataMigration.json --parameters eventHubNamespaceName=rsgeventhubnamespace eventHubName=hubdatamigration sqlServerName=rsgsqlservername sqlServerUserName=rsgusername sqlServerPassword=Incektiplaktor4539 sqlServerDatabaseName=rsgdatabasename storageName=rsguniquestoragename functionAppName=rsgappname
-------------------------------
{"status":"Failed","error":
   {"code":"DeploymentFailed",
          "target":"/subscriptions/cafb95de-39ce-4f0d-a9fe-db89b93c7ea2/resourceGroups/rgDataMigration/providers/Microsoft.Resources/deployments/RsgEventHubsDataMigration",
		  "message":"At least one resource deployment operation failed. Please list deployment operations for details. 
		  Please see https://aka.ms/arm-deployment-operations for usage details.",
		  "details":[{"code":"MessagingGatewayBadRequest","message":"SubCode=40000. 
		  Generic: Linked access check failed for capture storage destination /subscriptions/cafb95de-39ce-4f0d-a9fe-db89b93c7ea2/resourceGroups/rgDataMigration/providers/Microsoft.Storage/storageAccounts/rsguniquestoragename. 
		  User or the application with object id c1d5bfd7-b4fa-48c7-ae62-6984d0bfb4e3 making the request doesn't have the required data plane write permissions. 
		  Please enable 
		  	Microsoft.Storage/storageAccounts/blobServices/containers/write, 
		  	Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write permission(s) on above resource for the user or the application and retry. 
			TrackingId:ec9ed9b2-d490-42c2-9580-6ef579bb4be7_G11, SystemTracker:rsgeventhubnamespace.servicebus.windows.net:hubdatamigration, Timestamp:2023-12-18T07:34:07"},{"code":"NoRegisteredProviderFound","message":"No registered resource provider found for location 'eastus' and API version '2022-04-01' for type 'storageAccounts'. The supported api-versions are '2023-04-01, 2023-01-01, 2022-09-01, 2022-05-01, 2021-09-01, 2021-08-01, 2021-06-01, 2021-05-01, 2021-04-01, 2021-02-01, 2021-01-01, 2020-08-01-preview, 2019-06-01, 2019-04-01, 2018-11-01, 2018-07-01, 2018-03-01-preview, 2018-02-01, 2017-10-01, 2017-06-01, 2016-12-01, 2016-05-01, 2016-01-01, 2015-06-15, 2015-05-01-preview'. The supported locations are 'eastus, eastus2, westus, westeurope, eastasia, southeastasia, japaneast, japanwest, northcentralus, southcentralus, centralus, northeurope, brazilsouth, australiaeast, australiasoutheast, southindia, centralindia, westindia, canadaeast, canadacentral, westus2, westcentralus, uksouth, ukwest, koreacentral, koreasouth, francecentral, australiacentral, southafricanorth, uaenorth, switzerlandnorth, germanywestcentral, norwayeast, westus3, jioindiawest, swedencentral, qatarcentral, polandcentral, italynorth, israelcentral'."},{"code":"NoRegisteredProviderFound","message":"No registered resource provider found for location 'eastus' and API version '2022-04-01' for type 'storageAccounts'. The supported api-versions are '2023-04-01, 2023-01-01, 2022-09-01, 2022-05-01, 2021-09-01, 2021-08-01, 2021-06-01, 2021-05-01, 2021-04-01, 2021-02-01, 2021-01-01, 2020-08-01-preview, 2019-06-01, 2019-04-01, 2018-11-01, 2018-07-01, 2018-03-01-preview, 2018-02-01, 2017-10-01, 2017-06-01, 2016-12-01, 2016-05-01, 2016-01-01, 2015-06-15, 2015-05-01-preview'. The supported locations are 'eastus, eastus2, westus, westeurope, eastasia, southeastasia, japaneast, japanwest, northcentralus, southcentralus, centralus, northeurope, brazilsouth, australiaeast, australiasoutheast, southindia, centralindia, westindia, canadaeast, canadacentral, westus2, westcentralus, uksouth, ukwest, koreacentral, koreasouth, francecentral, australiacentral, southafricanorth, uaenorth, switzerlandnorth, germanywestcentral, norwayeast, westus3, jioindiawest, swedencentral, qatarcentral, polandcentral, italynorth, israelcentral'."}]}}
-------------------------------
{"code": "InvalidTemplate", "message": "Deployment template validation failed: 
'The template resource 'rsguniquestoragename/readRole' for type 'Microsoft.Authorization/roleAssignments' at line '163' and column '55' has incorrect segment lengths. A nested resource type must have identical number of segments as its resource name. A root resource type must have segment length one greater than its resource name. Please see https://aka.ms/arm-syntax-resources for usage details.'.", "additionalInfo": [{"type": "TemplateViolation", "info": {"lineNumber": 163, "linePosition": 55, "path": "resources[3].type"}}]}
------------------------------
az deployment group create --resource-group rgDataMigration --template-uri https://raw.githubusercontent.com/ridvansg/rsg_azure_tests/main/event-grid-rsg/RsgEventHubsDataMigration.json --parameters eventHubNamespaceName=rsgeventhubnamespace eventHubName=hubdatamigration sqlServerName=rsgsqlservername sqlServerUserName=rsgusername sqlServerPassword=Incektiplaktor4539 sqlServerDatabaseName=rsgdatabasename storageName=rsguniquestoragename functionAppName=rsgappname
{"code": "InvalidTemplate", "message": "Deployment template validation failed: 'The template resource 'rsguniquestoragename/default/Microsoft.Authorization/NEW-GUID' for type 'Microsoft.Authorization/roleAssignments' at line '163' and column '55' has incorrect segment lengths. A nested resource type must have identical number of segments as its resource name. A root resource type must have segment length one greater than its resource name. Please see https://aka.ms/arm-syntax-resources for usage details.'.", "additionalInfo": [{"type": "TemplateViolation", "info": {"lineNumber": 163, "linePosition": 55, "path": "resources[3].type"}}]}
------------------------------
az deployment group create --resource-group rgDataMigration --template-uri https://raw.githubusercontent.com/ridvansg/rsg_azure_tests/main/event-grid-rsg/RsgEventHubsDataMigration.json --parameters eventHubNamespaceName=rsgeventhubnamespace eventHubName=hubdatamigration sqlServerName=rsgsqlservername sqlServerUserName=rsgusername sqlServerPassword=Incektiplaktor4539 sqlServerDatabaseName=rsgdatabasename storageName=rsguniquestoragename functionAppName=rsgappname
{"status":"Failed","error":{"code":"DeploymentFailed","target":"/subscriptions/cafb95de-39ce-4f0d-a9fe-db89b93c7ea2/resourceGroups/rgDataMigration/providers/Microsoft.Resources/deployments/RsgEventHubsDataMigration","message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/arm-deployment-operations for usage details.","details":[{"code":"MessagingGatewayBadRequest","message":"SubCode=40000. Generic: Linked access check failed for capture storage destination /subscriptions/cafb95de-39ce-4f0d-a9fe-db89b93c7ea2/resourceGroups/rgDataMigration/providers/Microsoft.Storage/storageAccounts/rsguniquestoragename. User or the application with object id c1d5bfd7-b4fa-48c7-ae62-6984d0bfb4e3 making the request doesn't have the required data plane write permissions. Please enable Microsoft.Storage/storageAccounts/blobServices/containers/write, Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write permission(s) on above resource for the user or the application and retry. TrackingId:bcb31c66-ce7e-4131-a563-7167dff05d99_G38, SystemTracker:rsgeventhubnamespace.servicebus.windows.net:hubdatamigration, Timestamp:2023-12-17T16:48:03"}]}}
----------------------------


az deployment group create --resource-group rgDataMigration --template-uri https://raw.githubusercontent.com/Azure/azure-docs-json-samples/master/event-grid/EventHubsDataMigration.json --parameters eventHubNamespaceName=rsgeventhubnamespace eventHubName=hubdatamigration sqlServerName=rsgsqlservername sqlServerUserName=rsgusername sqlServerPassword=Incektiplaktor4539 sqlServerDatabaseName=rsgdatabasename storageName=rsguniquestoragename functionAppName=rsgappname

{"status":"Failed","error":
{"code":"DeploymentFailed",
 "target":"/subscriptions/cafb95de-39ce-4f0d-a9fe-db89b93c7ea2/resourceGroups/rgDataMigration/providers/Microsoft.Resources/deployments/EventHubsDataMigration",
 "message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/arm-deployment-operations for usage details.",
 "details":[
 {
	"code":"MessagingGatewayBadRequest",
	"message":"SubCode=40000. Generic: Linked access check failed for capture 
		storage destination /subscriptions/cafb95de-39ce-4f0d-a9fe-db89b93c7ea2/resourceGroups/rgDataMigration/providers/Microsoft.Storage/storageAccounts/rsguniquestoragename. 
		User or the application with object id c1d5bfd7-b4fa-48c7-ae62-6984d0bfb4e3 making the request doesn't have the required data plane write permissions. 
		   Please enable Microsoft.Storage/storageAccounts/blobServices/containers/write, Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write permission(s) on above resource for the user or the application and retry. 
		
		TrackingId:a17067bc-7660-44b4-a2fe-420e9262d61c_G15, SystemTracker:rsgeventhubnamespace.servicebus.windows.net:hubdatamigration, Timestamp:2023-12-17T09:11:57"}]}}


enable read and write permissions of User ridvansg to storage storageName ("rsguniquestoragename")